
## 1. in çš„åŸç†

å½“ä½ å†™ "hello" in temp æ—¶ï¼ŒPython ä¼šåšä»¥ä¸‹å‡ æ­¥ï¼š
æ£€æŸ¥ temp æ˜¯å¦æœ‰ __contains__ æ–¹æ³•ï¼š
å¦‚æœæœ‰ï¼Œå°±ç›´æ¥è°ƒç”¨ temp.__contains__("hello")ã€‚
å¦åˆ™ï¼Œçœ‹ temp æ˜¯å¦æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼ˆæœ‰æ²¡æœ‰ __iter__ æ–¹æ³•ï¼‰ï¼š
æœ‰çš„è¯ï¼Œå°±ç”¨ iter(temp) å¾—åˆ°ä¸€ä¸ªè¿­ä»£å™¨(å­—ç¬¦ä¸²è¿­ä»£å™¨ä¼šé€ä¸ªå–å‡ºå­—ç¬¦)ã€‚
ç„¶åä¸æ–­è°ƒç”¨ next()ï¼Œé€ä¸ªæ¯”è¾ƒå…ƒç´ æ˜¯å¦ç­‰äº "hello"ã€‚
å¦‚æœéƒ½ä¸æ»¡è¶³ï¼Œä¼šæŠ› TypeErrorã€‚

## 2. åˆ—è¡¨æ¨å¯¼å¼å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼

### 1. åˆ—è¡¨æ¨å¯¼å¼ï¼šåŠæ—©ç”Ÿæˆ (eager evaluation)

```python
lst = [x*x for x in range(5)]
print(lst)
```

è¾“å‡ºï¼š

```
[0, 1, 4, 9, 16]
```

ç‰¹ç‚¹ï¼š

* **ä¸€æ¬¡æ€§**æŠŠæ‰€æœ‰ç»“æœéƒ½ç®—å‡ºæ¥ï¼Œå­˜æ”¾åˆ°åˆ—è¡¨é‡Œã€‚
* å ç”¨å†…å­˜ = `ç»“æœæ•°é‡ * å•ä¸ªå…ƒç´ å¤§å°`ã€‚
* è®¿é—®ä»»æ„å…ƒç´ æ—¶æ˜¯ O(1)ï¼ˆå› ä¸ºå·²ç»å­˜åœ¨å†…å­˜é‡Œï¼‰ã€‚

âš ï¸ å¦‚æœç»“æœå¾ˆå¤§ï¼Œæ¯”å¦‚ `[x for x in range(10**8)]`ï¼Œä¼šç›´æ¥å ç”¨éå¸¸å¤šå†…å­˜ã€‚

---

### 2. ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼šæƒ°æ€§ç”Ÿæˆ (lazy evaluation)

```python
gen = (x*x for x in range(5))
print(gen)          # åªæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡
print(next(gen))    # 0
print(next(gen))    # 1
```

ç‰¹ç‚¹ï¼š

* ä¸ä¼šç«‹åˆ»ç®—å‡ºæ‰€æœ‰ç»“æœï¼Œè€Œæ˜¯ **ç”¨åˆ°ä¸€ä¸ªï¼Œç®—ä¸€ä¸ªï¼Œæ‰”ä¸€ä¸ª**ã€‚
* å†…å­˜å ç”¨æå°ï¼ˆåªå­˜å½“å‰çŠ¶æ€ï¼Œæ¯”å¦‚è¿­ä»£å™¨çš„ä½ç½®ï¼‰ã€‚
* åªèƒ½éå†ä¸€æ¬¡ï¼Œéå†å®Œäº†å°±æ²¡äº†ã€‚

é€‚åˆ **å¤§æ•°æ®é‡** æˆ– **æµå¼æ•°æ®å¤„ç†**ã€‚

---

### 3. å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§    | åˆ—è¡¨æ¨å¯¼å¼            | ç”Ÿæˆå™¨è¡¨è¾¾å¼     |
| ----- | ---------------- | ---------- |
| æ±‚å€¼æ–¹å¼  | åŠæ—©ç”Ÿæˆï¼ˆä¸€æ¬¡æ€§è®¡ç®—å‡ºæ‰€æœ‰å…ƒç´ ï¼‰ | æƒ°æ€§ç”Ÿæˆï¼ˆç”¨åˆ°æ‰ç®—ï¼‰ |
| å†…å­˜å ç”¨  | ä¸ç»“æœå¤§å°æˆæ­£æ¯”         | åªå å°‘é‡å†…å­˜     |
| å¯è¿­ä»£æ¬¡æ•° | å¤šæ¬¡ï¼ˆå› ä¸ºæ˜¯åˆ—è¡¨ï¼‰        | ä¸€æ¬¡ï¼ˆéå†åå°±æ²¡äº†ï¼‰ |
| æ€§èƒ½    | å°æ•°æ®æ—¶å¿«            | å¤§æ•°æ®æ—¶æ›´èŠ‚çœèµ„æº  |

---

ğŸ“Œ æ‰“ä¸ªæ¯”å–»ï¼š

* **åˆ—è¡¨æ¨å¯¼å¼** = ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰èœéƒ½åšå¥½ï¼Œæ‘†æ»¡æ¡Œå­ã€‚
* **ç”Ÿæˆå™¨è¡¨è¾¾å¼** = ä½ ç‚¹ä¸€é“èœï¼Œå¨å¸ˆç°ç‚’ä¸€é“ã€‚

---

## 3. iter() å‡½æ•°è°ƒç”¨æœºåˆ¶
1. æ£€æŸ¥å¯¹è±¡æ˜¯å¦å®ç°äº†__iter__æ–¹æ³•ï¼Œå¦‚æœå®ç°äº†å°±è°ƒç”¨å®ƒï¼Œè·å–ä¸€ä¸ªè¿­ä»£å™¨ã€‚
2. å¦‚æœæ²¡æœ‰å®ç°__iter__æ–¹æ³•ï¼Œä½†æ˜¯å®ç°äº†__getitem__æ–¹æ³•ï¼Œé‚£ä¹ˆiterï¼ˆï¼‰å°±ä¼šåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œ
å°è¯•æŒ‰ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰è·å–é¡¹ã€‚ï¼ˆä¹‹æ‰€ä»¥é€šè¿‡__getitem__æ–¹æ³•è¿­ä»£ï¼Œæ˜¯ä¸ºäº†å‘åå…¼å®¹ï¼Œæ‰€ä»¥è¯´å®ç°äº†è¯¥æ–¹æ³•ä¸€æ ·ä¼šè¢«è§†ä¸ºå¯è¿­ä»£å¯¹è±¡ã€‚ï¼‰
3. å¦‚æœå°è¯•å¤±è´¥ï¼Œåˆ™pythonæŠ›å‡ºå¼‚å¸¸ã€‚
4. iter()å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°â€”â€”ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å“¨ç¬¦ï¼Œå³æ ‡è®°å€¼ï¼Œå¦‚æœå¯è°ƒç”¨å¯¹è±¡è¿”å›å“¨ç¬¦ï¼Œåˆ™è¿­ä»£å™¨æŠ›å‡º `StopIteration`ï¼Œä¸äº§ç”Ÿå“¨ç¬¦ã€‚
5. è¿­ä»£å™¨ä¸æ˜¯ä»å·²æœ‰â€œç°æˆæ•°æ®â€é‡Œå–ï¼Œè€Œæ˜¯ æ¯æ¬¡ä¸»åŠ¨è°ƒç”¨å‡½æ•°ç”Ÿæˆæ–°æ•°æ®ã€‚

---

## 4. æ‚è°ˆ

1. æ£€æŸ¥æŸä¸ªå¯¹è±¡æ˜¯å¦èƒ½å¤Ÿè¿­ä»£ï¼Œæœ€å‡†ç¡®çš„æ–¹æ³•å°±æ˜¯è°ƒç”¨ iter()å‡½æ•°ï¼Œå¦‚æœä¸å¯è¿­ä»£å°±ä¼šå‘å‡ºå¼‚å¸¸ä¿¡æ¯ã€‚å› ä¸ºiterï¼ˆï¼‰è¿˜ä¼šå…¼å®¹å®ç°äº†__getitem__çš„ç±»ã€‚



## 4. å¯è¿­ä»£å¯¹è±¡å’Œè¿­ä»£å™¨

1. pythonä»å¯è¿­ä»£å¯¹è±¡ä¸­è·å–è¿­ä»£å™¨ã€‚å¯è¿­ä»£å¯¹è±¡ â€”â€” å®ç°äº†__iter__æˆ–__getitem__æ–¹æ³•çš„å¯¹è±¡ã€‚
2. è¿­ä»£å™¨ â€”â€” å®ç°äº† __next__ (è¿”å›åºåˆ—ä¸­çš„ä¸‹ä¸€é¡¹ï¼Œæ²¡æœ‰é¡¹å°±ä¼šæŠ›å‡º`StopIteration`)å’Œ__iter__(è¿”å› `self`)æ–¹æ³•çš„å¯¹è±¡ã€‚
3. è¿­ä»£å™¨å®ç°äº† __iter__ï¼Œæ‰€ä»¥å®ƒæœ¬èº«æ˜¯å¯è¿­ä»£å¯¹è±¡ã€‚
è¯­ä¹‰ä¸Šï¼šè¿­ä»£å™¨ä¸€æ¬¡æ€§ï¼Œè€Œæˆ‘ä»¬é€šå¸¸æŠŠâ€œå¯è¿­ä»£å¯¹è±¡â€ç†è§£ä¸ºâ€œå¯ä»¥åå¤éå†çš„å®¹å™¨â€ï¼Œæ‰€ä»¥ä¼šåŒºåˆ†å¼€æ¥ã€‚
4. äºŒè€…ä¹‹é—´çš„ä¸€å¤§å·®åˆ«åœ¨äº:è¿­ä»£å™¨æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œç”¨å®Œå°±æ²¡äº†ï¼Œå¯è¿­ä»£å¯¹è±¡åˆ™å¯ä»¥é‡å¤ä½¿ç”¨ã€‚

## 5. ç”Ÿæˆå™¨

1. ç”Ÿæˆå™¨å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼ŒåŒ…è£…ç”Ÿæˆå™¨å‡½æ•°çš„ä¸»ä½“ã€‚æŠŠç”Ÿæˆå™¨å¯¹è±¡ä¼ ç»™ next()å‡½æ•°æ—¶ï¼Œç”Ÿæˆå™¨å‡½æ•°æå‰æ‰§è¡Œå‡½æ•°ä¸»ä½“ä¸­çš„ä¸‹ä¸€ä¸ª
yieldè¯­å¥ï¼Œè¿”å›äº§å‡ºçš„å€¼ï¼Œå¹¶åœ¨å‡½æ•°ä¸»ä½“çš„å½“å‰ä½ç½®æš‚åœã€‚æœ€ç»ˆï¼Œå‡½æ•°çš„ä¸»ä½“è¿”å›æ—¶ï¼Œpythonåˆ›å»ºçš„å¤–å±‚ç”Ÿæˆå™¨è¿”å›`StopIteration`ã€‚
2. `yield from`è¡¨è¾¾å¼è¯­æ³•å¯ä»¥æŠŠä¸€ä¸ªç”Ÿæˆå™¨çš„å·¥ä½œå§”æ‰˜ç»™å­ç”Ÿæˆå™¨ã€‚å…¶ä¸­ï¼Œå§”æ‰˜ç”Ÿæˆå™¨ä½œä¸ºä¸­ä»‹ï¼Œå¯ä»¥æŠŠå¤–éƒ¨è°ƒç”¨æ–¹ä¸å­ç”Ÿæˆå™¨ç›´æ¥è¿æ¥ï¼Œä½¿å¾—äºŒè€…å¯ä»¥ç›´æ¥äº¤äº’ï¼ˆåŒ…æ‹¬ send()ã€throw() ç­‰ï¼‰ã€‚
å­ç”Ÿæˆå™¨ return çš„å€¼å¯ä»¥è¢«æ•è·ã€‚
3. ç”Ÿæˆå™¨å’Œè¿­ä»£å™¨çš„å¯¹æ¯”

### 1. åŸºæœ¬å®šä¹‰

| ç±»å‹                  | å®šä¹‰                                  | æ˜¯å¦è¿­ä»£å™¨ | æ˜¯å¦å¯è¿­ä»£ |
| ------------------- | ----------------------------------- | ----- | ----- |
| **è¿­ä»£å™¨ (iterator)**  | å®ç°äº† `__next__()` å’Œ `__iter__()` çš„å¯¹è±¡ | âœ…     | âœ…     |
| **ç”Ÿæˆå™¨ (generator)** | ä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨ï¼Œé€šè¿‡ `yield` äº§ç”Ÿå€¼             | âœ…     | âœ…     |

**ç»“è®º**ï¼š
ç”Ÿæˆå™¨ **æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§è¿­ä»£å™¨**ï¼Œæ‰€ä»¥ç”Ÿæˆå™¨å¯ä»¥ç›´æ¥ç”¨ `for` å¾ªç¯æˆ– `next()` éå†ã€‚

---

### 2. è¿­ä»£å™¨ç‰¹ç‚¹

* **ä¸€æ¬¡æ€§**ï¼šç”¨å®Œå°±æ²¡äº†ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆæ‰èƒ½å†éå†ã€‚
* **æ‰‹åŠ¨æˆ–è‡ªåŠ¨ç”Ÿæˆ**ï¼š

  * æ‰‹åŠ¨ï¼šè‡ªå®šä¹‰ç±»å®ç° `__next__`ã€‚
  * è‡ªåŠ¨ï¼šè°ƒç”¨ `iter(some_iterable)`ã€‚
* **ä¾‹å­**ï¼š

```python
lst = [1, 2, 3]
it = iter(lst)   # è¿­ä»£å™¨
print(next(it))  # 1
print(next(it))  # 2
```

---

### 3. ç”Ÿæˆå™¨ç‰¹ç‚¹

* **é€šè¿‡ `yield` å®šä¹‰**ï¼Œæ¯æ¬¡ `yield` è¿”å›ä¸€ä¸ªå€¼ã€‚
* **è¯­æ³•ç®€æ´**ï¼šä¸ç”¨å†™ `__next__`ã€`__iter__`ï¼ŒPython è‡ªåŠ¨å¸®ä½ ç”Ÿæˆè¿­ä»£å™¨å¯¹è±¡ã€‚
* **æƒ°æ€§æ±‚å€¼**ï¼šæ¯æ¬¡è¿­ä»£æ‰è®¡ç®—ä¸‹ä¸€æ­¥ç»“æœï¼Œä¸åƒåˆ—è¡¨ä¸€æ¬¡ç”Ÿæˆæ‰€æœ‰å…ƒç´ ã€‚
* **ä¾‹å­**ï¼š

```python
def gen():
    for i in range(3):
        yield i

g = gen()        # ç”Ÿæˆå™¨å¯¹è±¡
print(next(g))   # 0
print(next(g))   # 1
```

* **ç‰¹æ€§**ï¼š

  * å¯ä»¥ç”¨ `for` å¾ªç¯éå†
  * å¯ä»¥ç”¨ `send()` å‘ç”Ÿæˆå™¨ä¼ å€¼
  * ä¸€æ¬¡æ€§ä½¿ç”¨

---

### 4. è¿­ä»£å™¨ vs ç”Ÿæˆå™¨å¯¹æ¯”

| ç‰¹æ€§    | è¿­ä»£å™¨            | ç”Ÿæˆå™¨             |
| ----- | -------------- | --------------- |
| å®šä¹‰æ–¹å¼  | ç±»å®ç° `__next__` | å‡½æ•°ç”¨ `yield`     |
| æ˜¯å¦è¿­ä»£å™¨ | âœ…              | âœ…               |
| æ˜¯å¦å¯è¿­ä»£ | âœ…              | âœ…               |
| ä¸€æ¬¡æ€§   | âœ…              | âœ…               |
| æƒ°æ€§æ±‚å€¼  | å¯å®ç°            | é»˜è®¤æƒ°æ€§            |
| ä»£ç å¤æ‚åº¦ | é«˜ï¼Œéœ€è¦æ‰‹åŠ¨ç»´æŠ¤çŠ¶æ€     | ä½ï¼ŒPython è‡ªåŠ¨ç»´æŠ¤çŠ¶æ€ |
| å¯å‘é€å€¼  | âŒ              | âœ…ï¼ˆ`send()`ï¼‰     |

---

### 5. æ€»ç»“å…³ç³»

* **è¿­ä»£å™¨æ˜¯æ¦‚å¿µ**ï¼Œç”Ÿæˆå™¨æ˜¯å®ç°æ–¹å¼ä¹‹ä¸€ã€‚
* **ç”Ÿæˆå™¨ = å†™è¿­ä»£å™¨çš„å¿«æ·æ–¹å¼**ï¼Œå¯ä»¥åŠ¨æ€ç”Ÿæˆåºåˆ—ï¼Œè¯­æ³•æ›´ç®€æ´ã€‚
* è¿­ä»£å™¨å¯ä»¥é€šè¿‡ç”Ÿæˆå™¨å‡½æ•°å¿«é€Ÿåˆ›å»ºï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨å†™ç±»ã€‚

---

## 6. å¯è¿­ä»£å¯¹è±¡ã€è¿­ä»£å™¨å’Œç”Ÿæˆå™¨ï¼Œä¸‰è€…ä¹‹é—´çš„è”ç³»
---


### 1. **æ¦‚å¿µå®šä¹‰**

| åç§°                   | å®šä¹‰                                  | ç‰¹ç‚¹                  | æ˜¯å¦å¯è¿­ä»£ | æ˜¯å¦ä¸€æ¬¡æ€§        |
| -------------------- | ----------------------------------- | ------------------- | ----- | ------------ |
| **å¯è¿­ä»£å¯¹è±¡ (iterable)** | å®ç°äº† `__iter__()` çš„å¯¹è±¡                | å¯ä»¥ç”Ÿæˆè¿­ä»£å™¨             | âœ…     | âŒï¼ˆé€šå¸¸å¯ä»¥é‡å¤è¿­ä»£ï¼‰  |
| **è¿­ä»£å™¨ (iterator)**   | å®ç°äº† `__iter__()` å’Œ `__next__()` çš„å¯¹è±¡ | é€šè¿‡ `next()` è·å–ä¸‹ä¸€ä¸ªå€¼  | âœ…     | âœ…ï¼ˆä¸€æ¬¡æ€§ï¼Œç”¨å®Œå°±è€—å°½ï¼‰ |
| **ç”Ÿæˆå™¨ (generator)**  | ç”¨ `yield` å®šä¹‰çš„å‡½æ•°æˆ–ç”Ÿæˆå™¨è¡¨è¾¾å¼è¿”å›çš„å¯¹è±¡         | æœ¬è´¨ä¸Šæ˜¯è¿­ä»£å™¨ï¼Œæƒ°æ€§æ±‚å€¼ï¼Œè‡ªåŠ¨ç»´æŠ¤çŠ¶æ€ | âœ…     | âœ…ï¼ˆä¸€æ¬¡æ€§ï¼‰       |

---

### 2. **å½¢è±¡åŒ–**

* **å¯è¿­ä»£å¯¹è±¡** = ç³–ç›’ï¼Œä½ å¯ä»¥æ‹¿å‡ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¤šæ¬¡å–ç³–ï¼Œæ¯æ¬¡éƒ½æœ‰æ–°ä¼ é€å¸¦ã€‚
* **è¿­ä»£å™¨** = ä¼ é€å¸¦ï¼Œä¸€æ¬¡æ€§ï¼Œç³–ç”¨å®Œå°±æ²¡äº†ã€‚
* **ç”Ÿæˆå™¨** = è‡ªåŠ¨åŒ–ä¼ é€å¸¦ï¼Œä½ å†™ç”Ÿäº§æ­¥éª¤ï¼ŒPython è‡ªåŠ¨ç”Ÿæˆè¿­ä»£å™¨ï¼Œæ¯æ¬¡éœ€è¦ç³–æ—¶æ‰ç”Ÿäº§ã€‚


## 7. åç¨‹ï¼ˆcoroutineï¼‰æŠŠâ€œç»å…¸åç¨‹â€å’Œâ€œåŸç”Ÿåç¨‹â€çš„åŒºåˆ«

### 1. **åç¨‹ï¼ˆCoroutineï¼‰æ¦‚å¿µ**

* **å®šä¹‰**ï¼šåç¨‹æ˜¯ä¸€ç§**ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹**ï¼Œå¯ä»¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­**æš‚åœå¹¶è®©å‡ºæ§åˆ¶æƒ**ï¼Œç„¶ååœ¨é€‚å½“çš„æ—¶å€™**æ¢å¤æ‰§è¡Œ**ã€‚
* **ç‰¹ç‚¹**ï¼š

  1. **éæŠ¢å å¼**ï¼šåç¨‹åˆ‡æ¢ç”±ç¨‹åºæ§åˆ¶ï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦ã€‚
  2. **è½»é‡çº§**ï¼šä¸€ä¸ªçº¿ç¨‹ä¸­å¯ä»¥è¿è¡Œæˆç™¾ä¸Šåƒä¸ªåç¨‹ã€‚
  3. **é€‚åˆ IO å¯†é›†å‹ä»»åŠ¡**ï¼šå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ã€å¼‚æ­¥è®¡ç®—ã€‚

> ç®€å•æ¯”å–»ï¼šåç¨‹å°±åƒâ€œå¯æš‚åœçš„å‡½æ•°â€ï¼Œä½ å¯ä»¥åœ¨ä¸­é€”åœä¸‹æ¥å¤„ç†åˆ«çš„äº‹æƒ…ï¼Œç„¶åå†å›æ¥ç»§ç»­æ‰§è¡Œã€‚

---

### 2. **ç»å…¸åç¨‹ï¼ˆGenerator-based Coroutineï¼‰**

* **Python æ—©æœŸåç¨‹**ï¼ŒåŸºäº **ç”Ÿæˆå™¨ (`yield`)** å®ç°ã€‚
* **åŸç†**ï¼šç”¨ `yield` æš‚åœå‡½æ•°ï¼ŒæŠŠæ§åˆ¶æƒäº¤ç»™è°ƒåº¦å™¨æˆ–å¤–éƒ¨è°ƒç”¨æ–¹ã€‚

* **ç‰¹ç‚¹**ï¼š

  1. ä½¿ç”¨ `yield` æš‚åœå’Œæ¥æ”¶å¤–éƒ¨æ•°æ®ã€‚
  2. éœ€è¦ **æ‰‹åŠ¨é¢„æ¿€æ´»**ï¼ˆè°ƒç”¨ä¸€æ¬¡ `next()`ï¼‰ã€‚

* **ç”¨é€”**ï¼š

  * å¼‚æ­¥ IO æ¡†æ¶ï¼ˆå¦‚æ—§ç‰ˆ asyncioï¼‰
  * æµç¨‹æ§åˆ¶ã€ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹

---

### 3. **åŸç”Ÿåç¨‹ï¼ˆNative Coroutineï¼‰**

* **Python 3.5+** å¼•å…¥ **`async def` / `await`** è¯­æ³•
* **å®šä¹‰**ï¼šç›´æ¥ç”¨ `async def` å®šä¹‰å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåç¨‹å¯¹è±¡ï¼Œå¯ç”¨ `await` æš‚åœç­‰å¾…å¦ä¸€ä¸ªåç¨‹å®Œæˆã€‚
* **ç‰¹ç‚¹**ï¼š

  1. ä¸éœ€è¦æ‰‹åŠ¨é¢„æ¿€æ´»ï¼ŒPython è‡ªåŠ¨ç®¡ç†ã€‚
  2. å¯ä»¥ç›´æ¥ `await` å…¶ä»–åç¨‹ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ã€‚
  3. ä¸ `asyncio`ã€å¼‚æ­¥æ¡†æ¶å¤©ç„¶å…¼å®¹ã€‚

* **ç”¨é€”**ï¼š

  * å¼‚æ­¥ç½‘ç»œè¯·æ±‚ï¼ˆaiohttpï¼‰
  * å¼‚æ­¥æ–‡ä»¶æ“ä½œ
  * é«˜å¹¶å‘ IO åœºæ™¯

---

### 4. **ç»å…¸åç¨‹ vs åŸç”Ÿåç¨‹å¯¹æ¯”**

| ç‰¹æ€§        | ç»å…¸åç¨‹            | åŸç”Ÿåç¨‹                  |
| --------- | --------------- | --------------------- |
| å®ç°æ–¹å¼      | åŸºäºç”Ÿæˆå™¨ `yield`   | åŸºäº `async/await`      |
| é¢„æ¿€æ´»       | éœ€è¦ `next()`     | è‡ªåŠ¨ç®¡ç†                  |
| å¯åµŒå¥—è°ƒç”¨     | éœ€è¦ `yield from` | å¯ç›´æ¥ `await`           |
| è¯­æ³•æ¸…æ™°åº¦     | ç›¸å¯¹å¤æ‚            | æ¸…æ™°ç›´è§‚                  |
| Python ç‰ˆæœ¬ | 3.3+            | 3.5+                  |
| åº”ç”¨        | å°å‹å¼‚æ­¥ä»»åŠ¡ã€æ•™å­¦æ¼”ç¤º     | ç°ä»£ asyncioã€ç½‘ç»œ IOã€å¹¶å‘ä»»åŠ¡ |

---

ğŸ’¡ **æ€»ç»“**ï¼š

* **åç¨‹** = å¯ä»¥æš‚åœçš„å‡½æ•°
* **ç»å…¸åç¨‹** = ç”¨ `yield` åšåç¨‹
* **åŸç”Ÿåç¨‹** = ç”¨ `async def` + `await` åšåç¨‹ï¼Œæ›´ç°ä»£ã€æ›´å¼ºå¤§
* **ä¸­æ­¢åç¨‹** ï¼šå¯ä»¥é€šè¿‡.close()æ–¹æ³•ç›´æ¥å–æ¶ˆå¼•ç”¨ï¼Œå› ä¸ºä¸€æ—¦æ²¡æœ‰å¯¹ç”Ÿæˆå™¨Â·çš„æœ‰æ•ˆå¼•ç”¨ï¼Œç”Ÿæˆå™¨å°±ä¼šè¢«å½“ä½œåƒåœ¾å›æ”¶ã€‚

---

## 8. yieldæ–°ç”¨æ³•
### 1. ç¬¬ä¸€æ¬¡è¦`next()` æˆ– `send(None)`ï¼Œè¿›è¡Œç”Ÿæˆå™¨å¯åŠ¨ã€‚

* å½“ä½ è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ï¼ˆ`gen()`ï¼‰æ—¶ï¼Œå®ƒåªæ˜¯**è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡**ï¼Œ**ä¸ä¼šæ‰§è¡Œå‡½æ•°ä½“**ã€‚

```python
def gen():
    x = yield 10
```

* æ­¤æ—¶ç”Ÿæˆå™¨è¿˜æ²¡æœ‰åˆ° `yield` è¯­å¥çš„ä½ç½®ã€‚
* ä½ å¿…é¡»å…ˆ**æŠŠç”Ÿæˆå™¨â€œæ¨è¿›åˆ°ç¬¬ä¸€ä¸ª yieldâ€**ï¼Œæ‰èƒ½è®©å®ƒæš‚åœï¼Œå‡†å¤‡æ¥æ”¶ `send()` ä¼ å…¥çš„å€¼ã€‚

```python
g = gen()
next(g)        # å¯åŠ¨ç”Ÿæˆå™¨ï¼Œæ‰§è¡Œåˆ° yield 10 æš‚åœ
```

### 2. .send()æ–¹æ³•

* `yield` ä¸åªæ˜¯â€œäº§å‡ºå€¼â€ï¼Œåœ¨ **èµ‹å€¼è¯­æ³•**ä¸‹ï¼Œå®ƒæœ¬èº«æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼š

```python
received = yield value
```

* æ‰§è¡Œè¿‡ç¨‹ï¼š

1. ç”Ÿæˆå™¨æš‚åœåœ¨ `yield value`ï¼ŒæŠŠ `value` è¾“å‡ºç»™å¤–éƒ¨ã€‚
2. å¤–éƒ¨è°ƒç”¨ `send(some_val)` ç»§ç»­ç”Ÿæˆå™¨æ‰§è¡Œ
3. **`yield value` è¡¨è¾¾å¼çš„ç»“æœå°±æ˜¯ `send()` ä¼ å…¥çš„å€¼**
4. æ‰€ä»¥ `received = yield value` â†’ `received = some_val`

> å¯ä»¥ç†è§£ä¸ºï¼š
>
> * `yield value`ï¼šç”Ÿæˆå™¨â€œæŠ›å‡ºâ€ä¸€ä¸ªå€¼ç»™å¤–éƒ¨
> * `send(val)`ï¼šå¤–éƒ¨â€œé€å›â€ä¸€ä¸ªå€¼ç»™ç”Ÿæˆå™¨
> * è¿™ä¸ªå€¼å°±æˆä¸º `yield` è¡¨è¾¾å¼çš„è¿”å›å€¼

---

 **ç¤ºä¾‹**

```python
def gen():
    print("Start")
    x = yield 10   # æš‚åœï¼Œè¾“å‡º 10
    print("x received:", x)
    y = yield 20
    print("y received:", y)

g = gen()
print(next(g))     # å¯åŠ¨ç”Ÿæˆå™¨ï¼Œè¾“å‡º 10
print(g.send(99))  # send 99 ç»™ xï¼Œè¾“å‡º "x received: 99"ï¼Œäº§å‡º 20
g.send(88)         # send 88 ç»™ yï¼Œè¾“å‡º "y received: 88"
```

**è¾“å‡ºï¼š**

```
Start
10
x received: 99
20
y received: 88
```
### 3.å°ç»“
yield value çš„ value éƒ¨åˆ†æ˜¯â€œè¦ç»™å¤–éƒ¨çš„å€¼â€ã€‚

received = yield value æ˜¯æœ€å¸¸è§çš„å†™æ³•ï¼Œå› ä¸ºä½ åŒæ—¶è¦ï¼š

ç»™å¤–éƒ¨ä¸€ä¸ªå€¼ï¼ˆvalueï¼‰ï¼›

åœ¨å†…éƒ¨æ‹¿åˆ°å¤–éƒ¨ä¸‹æ¬¡ä¼ å›æ¥çš„å€¼ï¼ˆreceivedï¼‰ã€‚

å¦‚æœä½ åªå†™ received = yieldï¼š

å¤–éƒ¨æ‹¿åˆ°çš„æ˜¯ Noneï¼Œ

å†…éƒ¨è¿˜æ˜¯èƒ½é€šè¿‡ received æ¥æ”¶åˆ° send çš„å€¼ã€‚

