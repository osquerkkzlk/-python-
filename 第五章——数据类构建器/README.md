## ğŸ“˜ç¬¬äº”ç«  æ ¸å¿ƒä¸»é¢˜ï¼šæ•°æ®ç±»æ„å»ºå™¨ï¼ˆData Class Buildersï¼‰

---

### ä¸€ã€ä¸ºä½•éœ€è¦æ•°æ®ç±»æ„å»ºå™¨ï¼Ÿ

ä¼ ç»Ÿçš„ç±»ï¼ˆ`__init__`ã€`__repr__`ã€`__eq__` ç­‰ï¼‰æ‰‹åŠ¨ç¼–å†™å†—é•¿è€Œæ˜“å‡ºé”™ã€‚æ•°æ®ç±»æ„å»ºå™¨æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„ï¼Œå®ƒä»¬è®©æ•°æ®å°è£…æ›´ç®€å•ã€æ›´è§„èŒƒã€‚

---

### äºŒã€ä¸»è¦æ„å»ºå·¥å…·å¯¹æ¯”

| å·¥å…·                      | ç®€ä»‹                   | Pythonç‰ˆæœ¬ | æ˜¯å¦å†…ç½® |
| ----------------------- | -------------------- | -------- | ---- |
| `namedtuple`            | åˆ›å»ºä¸å¯å˜çš„ã€è½»é‡çº§æ•°æ®å®¹å™¨       | 2.6+     | âœ…    |
| `typing.NamedTuple`     | æ”¯æŒç±»å‹æ³¨è§£çš„ `namedtuple` | 3.5+     | âœ…    |
| `dataclasses.dataclass` | æä¾›é»˜è®¤æ–¹æ³•ã€å¯å˜æ€§æ§åˆ¶         | 3.7+     | âœ…    |
| `attrs` ç¬¬ä¸‰æ–¹åº“            | æœ€å¼ºå¤§ã€æœ€çµæ´»çš„æ•°æ®ç±»å·¥å…·        | 3.5+     | âŒ    |

---

### ä¸‰ã€`collections.namedtuple` çš„åŸºæœ¬ç”¨æ³•

```python
from collections import namedtuple

Coordinate = namedtuple('Coordinate', 'x y')
point = Coordinate(10, 20)
print(point.x, point.y)  # è¾“å‡ºï¼š10 20
```

* ä¸å¯å˜ï¼ˆimmutableï¼‰
* æ”¯æŒè§£åŒ…ã€ç´¢å¼•ã€å±æ€§è®¿é—®
* é€‚åˆåªè¯»ç»“æ„
* æ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼Œä¸é€‚åˆå¤§å‹é¡¹ç›®ä¸­é•¿æœŸä½¿ç”¨
* namedtupleä¸»è¦æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šç±»åå’Œå¯¹è±¡ååˆ—è¡¨ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œä¹Ÿæœ‰ä¸€ä¸ªé»˜è®¤å‚æ•°defaultsï¼Œä¸ºä»å³æ•°çš„nä¸ªå­—æ®µæŒ‡å®šé»˜è®¤å€¼,ä¸€ä¸€å¯¹åº”
* _addictæ–¹æ³•è¿”å›æ ¹æ®å…·åå…ƒç»„å®ä¾‹æ„å»ºçš„dictå¯¹è±¡

---

### å››ã€`typing.NamedTuple`ï¼šç±»å‹æ³¨è§£æ”¯æŒçš„å‘½åå…ƒç»„

```python
from typing import NamedTuple

class Coordinate(NamedTuple):
    x: int
    y: int
```

* ä»ä¸å¯å˜
* æ·»åŠ äº†ç±»å‹æ³¨è§£ï¼Œæ›´æ¸…æ™°æ›´æ˜“ç»´æŠ¤
* æ”¯æŒé»˜è®¤å€¼ã€æ–‡æ¡£å­—ç¬¦ä¸²ç­‰é«˜çº§ç‰¹æ€§

---

### äº”ã€`dataclasses.dataclass`ï¼šç°ä»£æ•°æ®ç±»çš„é¦–é€‰

```python
from dataclasses import dataclass

@dataclass
class Coordinate:
    x: int
    y: int
```

* è‡ªåŠ¨ç”Ÿæˆ `__init__`, `__repr__`, `__eq__` ç­‰æ–¹æ³•
* æ”¯æŒå¯å˜ä¸ä¸å¯å˜é…ç½®ï¼ˆ`frozen=True`ï¼‰
* æ”¯æŒé»˜è®¤å€¼ã€é»˜è®¤å·¥å‚ã€æ’åºï¼ˆ`order=True`ï¼‰
* æ›´çµæ´»ï¼Œé€‚åˆç°å®é¡¹ç›®ä¸­çš„æ•°æ®å°è£…

---

#### ç¤ºä¾‹ï¼šé»˜è®¤å€¼ä¸æ’åº

```python
from dataclasses import dataclass, field

@dataclass(order=True)
class Task:
    priority: int
    description: str = field(compare=False, default="")

task1 = Task(1, "write code")
task2 = Task(3, "test code")
print(task1 < task2)  # è¾“å‡ºï¼šTrue
```

---

### ä¸ƒã€é€‰æ‹©å»ºè®®

| ä½¿ç”¨åœºæ™¯                 | æ¨èå·¥å…·                |
| -------------------- | ------------------- |
| å¿«é€Ÿå®šä¹‰ä¸å¯å˜æ•°æ®            | `namedtuple`        |
| æƒ³ä½¿ç”¨ç±»å‹æ³¨è§£              | `typing.NamedTuple` |
| é¡¹ç›®ä¸­å¯å˜/ä¸å¯å˜ã€æ’åºã€é»˜è®¤å€¼ç­‰éœ€æ±‚å¤š | `@dataclass` âœ…      | 

---

### å…«ã€å¸¸è§å‘ç‚¹ä¸å»ºè®®

* `@dataclass` é»˜è®¤æ˜¯å¯å˜çš„ï¼Œå¦‚æœä½ éœ€è¦ä¸å¯å˜å¯¹è±¡ï¼Œè¯·åŠ ä¸Š `frozen=True`
* `NamedTuple` ä¸æ”¯æŒåŠ¨æ€å­—æ®µè®¾ç½®ï¼ˆä¸å¯å˜ï¼‰
* ä¸è¦éšæ„æ··ç”¨ `dataclass` ä¸æ™®é€šç±»æ–¹æ³•ï¼Œéµå¾ªå•ä¸€èŒè´£
* å¯¹è±¡ç”±ç±»é€ ï¼Œç±»ç”±å…ƒç±»é€ ï¼Œç±»èƒ½ç»§æ‰¿ç±»ï¼Œé‚£å«åšè¶…ç±»

---
### ä¹ã€ç±»å‹æç¤ºç¬¦
1. ç±»å‹æç¤ºç¬¦å¯¹ python ç¨‹åºè¿è¡Œæ²¡æœ‰å½±å“ï¼Œè¿è¡Œæ—¶ä¸æ£€æŸ¥ç±»å‹
2. ç±»å±æ€§å­˜åœ¨äºç±»æœ¬èº«çš„å‘½åç©ºé—´ä¸­ï¼Œå®ä¾‹å±æ€§å­˜åœ¨äºå®ä¾‹å­—å…¸ä¸­ï¼Œå®ä¾‹å±æ€§ä¼˜å…ˆäºç±»å±æ€§
3. å¯¹äºæ™®é€šçš„ç±»è€Œè¨€ï¼Œåªå†™äº†ç±»å‹æ³¨è§£ï¼Œæ²¡æœ‰èµ‹å€¼ï¼Œä¸ä¼šè‡ªåŠ¨æˆä¸ºç±»å˜é‡æˆ–å®ä¾‹å˜é‡ï¼Œåè€Œä¼šè¢«ä¸¢å¼ƒ
4. å¯¹äºç»§æ‰¿NamedTupleç±»è€Œè¨€,æ— è®ºåŠ ä¸Šæ³¨è§£ä¸å¦ï¼Œç¼–è¯‘å™¨éƒ½ä¼šå°è¯•æŠŠä»–å˜æˆå­—æ®µ,éæ³¨è§£å­—æ®µä¸ç®—åœ¨å­—æ®µé‡Œï¼Œè¿™å°±æ„å‘³ç€ä¸èƒ½å¯¹ä»–ä¸»åŠ¨èµ‹å€¼
5. å­—æ®µæ˜¯æŒ‡ç±»ä¸­å®šä¹‰çš„å˜é‡æˆ–å±æ€§ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªå¯¹è±¡çš„æ•°æ®å†…å®¹
6. å¯¹äºdtaclassè€Œè¨€ï¼Œç±»å‹æ³¨è§£å±æ€§ä¸æ˜¯ç±»å±æ€§ï¼Œéœ€è¦åˆ›å»ºå®ä¾‹ä¹‹åæ‰èƒ½æ­£å¸¸è®¿é—®ï¼Œæ²¡æœ‰ç±»å‹æ³¨è§£çš„å˜é‡ï¼Œå®ƒæ˜¯ç±»å±æ€§ï¼Œæ‰€æœ‰å®ä¾‹å…±äº«è¯¥å±æ€§

---

### åã€å­—æ®µé€‰é¡¹

1. å¸¦é»˜è®¤å€¼çš„å‚æ•°åé¢ä¸èƒ½æœ‰ä¸å¸¦é»˜è®¤å€¼çš„å‚æ•°ï¼Œå› æ­¤ï¼Œä¸ºä¸€ä¸ªå­—æ®µå£°æ˜é»˜è®¤å€¼ä¹‹åï¼Œä½™ä¸‹çš„å­—æ®µéƒ½è¦æœ‰é»˜è®¤å€¼
2. â— å¯å˜é»˜è®¤å€¼ï¼ˆå¦‚ list, dict, setï¼‰åœ¨ç±»ä¸­ä¼šè¢«â€œæ‰€æœ‰å®ä¾‹å…±äº«â€ï¼Œé™¤éç‰¹åˆ«å¤„ç†ã€‚
3. å¯¹äºfieldå‡½æ•°ï¼Œå¯å˜å­—æ®µå¿…é¡»ä½¿ç”¨default_factoryå‚æ•°ï¼Œä¹‹åè¯¥å±æ€§ä¸ä¼šå…±äº«ï¼›ä¸å¯å˜å­—æ®µæœ¬èº«å°±æ˜¯å®ä¾‹å±æ€§å¯ä¸ä¼šå…±äº«ï¼Œè‹¥ä½¿ç”¨defaultå‚æ•°ä¹‹åï¼Œåˆ™è¯¥å±æ€§ä¼šå…±äº«
4. å¯¹äºfieldså‡½æ•°ï¼Œå¯ä»¥å¿«é€Ÿè·å–æŸä¸ªç±»çš„å±æ€§ä¿¡æ¯ï¼Œå¦‚f.default,f.name,f.type
5. 

---

# åä¸€ã€é¡¹ç›®å®æˆ˜ï¼š
## ğŸ”§ é¡¹ç›®åç§°ï¼š**æ ¡å›­å¿«é€’åŒ…è£¹æ™ºèƒ½æ´¾é€ç³»ç»Ÿï¼ˆç®€åŒ–åŸå‹ï¼‰**

### ğŸ¯ é¡¹ç›®ç›®æ ‡ï¼š

ç”¨ Python æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªæ ¡å›­å¿«é€’æŸœç³»ç»Ÿï¼Œæ¶‰åŠï¼š

* æ•°æ®ç»“æ„æŠ½è±¡ï¼ˆåŒ…è£¹ã€å¿«é€’æŸœã€ç”¨æˆ·ï¼‰
* ä½¿ç”¨ `@dataclass` å’Œ `NamedTuple` æ„å»ºå®ä½“
* åˆ©ç”¨ç‰¹æ®Šæ–¹æ³•ï¼ˆå¦‚ `__repr__`, `__eq__`, `__lt__` ç­‰ï¼‰
* åˆ‡ç‰‡ã€æ’åºã€è¿‡æ»¤ã€å¯å˜åºåˆ—ã€å·¥å‚æ–¹æ³•ç­‰æŠ€æœ¯

---

## ğŸ§± æ¨¡å—è§„åˆ’

### âœ… 1. æ•°æ®ç»“æ„è®¾è®¡ï¼ˆå¤ä¹ ç¬¬2ï½5ç« ï¼‰

| å®ä½“                     | æŠ€æœ¯ç‚¹                               | æè¿°                   |
| ---------------------- | --------------------------------- | -------------------- |
| `Parcel`ï¼ˆåŒ…è£¹ï¼‰           | `@dataclass`, `field`, `__repr__` | å­˜å‚¨åŒ…è£¹ IDã€æ”¶ä»¶äººã€é‡é‡ã€å¿«é€’å…¬å¸ç­‰ |
| `Locker`ï¼ˆå¿«é€’æŸœï¼‰          | `NamedTuple`, ä¸å¯å˜åºåˆ—               | å­˜å‚¨æ ¼å­ç¼–å·ã€æœ€å¤§é‡é‡é™åˆ¶ã€æ˜¯å¦ç©ºé—²ç­‰  |
| `User`ï¼ˆç”¨æˆ·ï¼‰             | æ™®é€šç±» + å±æ€§è®¿é—®ã€åˆ‡ç‰‡                     | å­˜å‚¨ç”¨æˆ·æ”¶ä»¶è®°å½•ï¼Œå¯ä½¿ç”¨ç´¢å¼•åˆ‡ç‰‡è®¿é—®   |
| `DispatchCenter`ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰ | å·¥å‚å‡½æ•°ã€å®¹å™¨åè®®ã€æ’åº                      | ç®¡ç†åŒ…è£¹åˆ†é…é€»è¾‘             |

---

### âœ… 2. åŠŸèƒ½æ¨¡å—è®¾è®¡ï¼ˆå¯¹åº”ç« èŠ‚åŠŸèƒ½ï¼‰

#### ğŸ§© åŒ…è£¹å¤„ç†ç³»ç»Ÿï¼ˆdataclass + fieldï¼‰

```python
@dataclass
class Parcel:
    pid: str
    recipient: str
    weight: float
    company: str
    fragile: bool = False
    logs: list = field(default_factory=list, repr=False)
```

#### ğŸ§© å¿«é€’æŸœï¼ˆNamedTupleï¼‰

```python
from typing import NamedTuple

class Locker(NamedTuple):
    id: str
    max_weight: float
    is_empty: bool = True
```

#### ğŸ§© ç”¨æˆ·æ”¶ä»¶å†å²ï¼ˆæ”¯æŒåˆ‡ç‰‡ã€è¿­ä»£ï¼‰

```python
class User:
    def __init__(self, name):
        self.name = name
        self.parcel_history = []

    def add_parcel(self, parcel):
        self.parcel_history.append(parcel)

    def __getitem__(self, index):
        return self.parcel_history[index]
```

#### ğŸ§© è°ƒåº¦ä¸­å¿ƒï¼ˆå¤ä¹ æ’åºä¸ç‰¹æ®Šæ–¹æ³•ï¼‰

```python
class DispatchCenter:
    def __init__(self):
        self.parcels = []

    def register(self, parcel):
        self.parcels.append(parcel)

    def sorted_by_weight(self):
        return sorted(self.parcels, key=lambda x: x.weight)

    def __repr__(self):
        return f"<DispatchCenter with {len(self.parcels)} parcels>"
```

---

## ğŸ” æŠ€æœ¯ç‚¹å›é¡¾å¯¹ç…§

| ç« èŠ‚  | æŠ€æœ¯ç‚¹        | åœ¨é¡¹ç›®ä¸­çš„ä½“ç°                             |
| --- | ---------- | ----------------------------------- |
| ç¬¬1ç«  | å†…ç½®åºåˆ—       | ç”¨æˆ·åŒ…è£¹è®°å½•ã€åˆ‡ç‰‡ã€æ’åº                        |
| ç¬¬2ç«  | ç‰¹æ®Šæ–¹æ³•       | `__getitem__`, `__repr__`, `__eq__` |
| ç¬¬3ç«  | æŠ½è±¡ç±»        | å¯é€‰ï¼šæŠ½è±¡ä¸€ä¸ª `StorageUnit`               |
| ç¬¬4ç«  | NamedTuple | å¿«é€’æŸœä¸å¯å˜æ•°æ®å»ºæ¨¡                          |
| ç¬¬5ç«  | dataclass  | åŒ…è£¹ä¿¡æ¯ã€é»˜è®¤å€¼è®¾ç½®ã€å­—æ®µæ§åˆ¶                     |

---

## ğŸ¯ é¡¹ç›®åˆ†ä»»åŠ¡æ¸…å•

1. âœ… è®¾è®¡ `Parcel`, `Locker`, `User`, `DispatchCenter` ç±»ï¼›
2. âœ… ä½¿ç”¨ `@dataclass` æ­£ç¡®æ§åˆ¶é»˜è®¤å€¼ï¼ˆå¤ä¹  field å’Œ default\_factoryï¼‰ï¼›
3. âœ… ç”¨æˆ·æ”¯æŒä½¿ç”¨åˆ‡ç‰‡è®¿é—®æ”¶ä»¶å†å²ï¼›
4. âœ… `DispatchCenter` æ”¯æŒæ’åºåŒ…è£¹ã€ç­›é€‰ fragileï¼›
5. âœ… ç”¨ `NamedTuple` è¡¨è¾¾ locker çŠ¶æ€ï¼Œåªè¯»ä½†ç»“æ„æ¸…æ™°ï¼›
6. âœ… æ·»åŠ ç‰¹æ®Šæ–¹æ³•ï¼ˆå¦‚ `__repr__`ã€`__eq__`ï¼‰ä¾¿äºè°ƒè¯•å’Œæ¯”è¾ƒï¼›
7. âœ… æ‹“å±•ç‚¹ï¼šå®ç°åŒ…è£¹ç¼–å·æŸ¥é‡ã€æ€»é‡é‡é™åˆ¶ã€æŒ‰å…¬å¸åˆ†ç±»ã€‚

---

## ğŸ“Œ ç¤ºä¾‹è°ƒç”¨ï¼š

```python
p1 = Parcel("PKG001", "Alice", 1.2, "é¡ºä¸°")
p2 = Parcel("PKG002", "Bob", 3.5, "ä¸­é€š", fragile=True)

center = DispatchCenter()
center.register(p1)
center.register(p2)

print(center.sorted_by_weight())
```

---

## ğŸ§  è¿›é˜¶æ‹“å±•ï¼ˆå¯é€‰ï¼‰

* ä½¿ç”¨ `@classmethod` å†™ä¸€ä¸ªä»å­—å…¸åŠ è½½ Parcel çš„å·¥å‚æ–¹æ³•ï¼›
* æ¨¡æ‹Ÿç”¨æˆ·æ‰«ç å–ä»¶ï¼Œä¿®æ”¹ locker çŠ¶æ€ï¼›
* ç»Ÿè®¡å…¬å¸å æ¯”ï¼Œåšç®€å•æ•°æ®åˆ†æï¼ˆpandasï¼‰ï¼›
* æ·»åŠ æ§åˆ¶å°èœå•æ“ä½œï¼Œæå‡äº¤äº’æ€§ã€‚

---

